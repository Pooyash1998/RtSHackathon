<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test URL Extraction</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .test-case {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 8px;
            background: #f9f9f9;
        }
        .input {
            font-family: monospace;
            background: #fff;
            padding: 8px;
            border-radius: 4px;
            margin: 5px 0;
            display: block;
        }
        .output {
            font-family: monospace;
            background: #e8f5e9;
            padding: 8px;
            border-radius: 4px;
            margin: 5px 0;
            display: block;
        }
        .success { color: green; }
        .error { color: red; }
    </style>
</head>
<body>
    <h1>üß™ Classroom ID Extraction Test</h1>
    <p>Testing the extraction of classroom ID from various input formats:</p>

    <div id="test-results"></div>

    <script>
        // Helper function to extract classroom ID (same as in JoinClassroom.tsx)
        function extractClassroomId(input) {
            const trimmedInput = input.trim();
            
            // Check if it's a full URL
            if (trimmedInput.startsWith('http://') || trimmedInput.startsWith('https://')) {
                try {
                    const url = new URL(trimmedInput);
                    // Extract the last part of the path (the classroom ID)
                    const pathParts = url.pathname.split('/').filter(part => part.length > 0);
                    return pathParts[pathParts.length - 1];
                } catch (error) {
                    console.error("Failed to parse URL:", error);
                    return trimmedInput;
                }
            }
            
            // If it contains a slash, extract the last part
            if (trimmedInput.includes('/')) {
                const parts = trimmedInput.split('/').filter(part => part.length > 0);
                return parts[parts.length - 1];
            }
            
            // Otherwise, assume it's already just the classroom ID
            return trimmedInput;
        }

        // Test cases
        const testCases = [
            {
                name: "Full URL (localhost:8080)",
                input: "http://localhost:8080/student/join/942f3ae3-1dbd-4b7c-afd3-135b3e386de1",
                expected: "942f3ae3-1dbd-4b7c-afd3-135b3e386de1"
            },
            {
                name: "Full URL (localhost:5173)",
                input: "http://localhost:5173/student/join/942f3ae3-1dbd-4b7c-afd3-135b3e386de1",
                expected: "942f3ae3-1dbd-4b7c-afd3-135b3e386de1"
            },
            {
                name: "Full URL (HTTPS)",
                input: "https://example.com/student/join/942f3ae3-1dbd-4b7c-afd3-135b3e386de1",
                expected: "942f3ae3-1dbd-4b7c-afd3-135b3e386de1"
            },
            {
                name: "Just the UUID",
                input: "942f3ae3-1dbd-4b7c-afd3-135b3e386de1",
                expected: "942f3ae3-1dbd-4b7c-afd3-135b3e386de1"
            },
            {
                name: "Path without domain",
                input: "/student/join/942f3ae3-1dbd-4b7c-afd3-135b3e386de1",
                expected: "942f3ae3-1dbd-4b7c-afd3-135b3e386de1"
            },
            {
                name: "With trailing slash",
                input: "http://localhost:8080/student/join/942f3ae3-1dbd-4b7c-afd3-135b3e386de1/",
                expected: "942f3ae3-1dbd-4b7c-afd3-135b3e386de1"
            },
            {
                name: "With extra spaces",
                input: "  942f3ae3-1dbd-4b7c-afd3-135b3e386de1  ",
                expected: "942f3ae3-1dbd-4b7c-afd3-135b3e386de1"
            },
            {
                name: "Short code (legacy)",
                input: "class-1",
                expected: "class-1"
            }
        ];

        // Run tests
        const resultsDiv = document.getElementById('test-results');
        let passCount = 0;
        let failCount = 0;

        testCases.forEach((testCase, index) => {
            const result = extractClassroomId(testCase.input);
            const passed = result === testCase.expected;
            
            if (passed) passCount++;
            else failCount++;

            const testDiv = document.createElement('div');
            testDiv.className = 'test-case';
            testDiv.innerHTML = `
                <h3>${passed ? '‚úÖ' : '‚ùå'} Test ${index + 1}: ${testCase.name}</h3>
                <div>
                    <strong>Input:</strong>
                    <span class="input">${testCase.input}</span>
                </div>
                <div>
                    <strong>Expected:</strong>
                    <span class="output">${testCase.expected}</span>
                </div>
                <div>
                    <strong>Got:</strong>
                    <span class="output ${passed ? 'success' : 'error'}">${result}</span>
                </div>
                ${!passed ? `<p class="error">‚ùå FAILED: Expected "${testCase.expected}" but got "${result}"</p>` : ''}
            `;
            resultsDiv.appendChild(testDiv);
        });

        // Summary
        const summaryDiv = document.createElement('div');
        summaryDiv.className = 'test-case';
        summaryDiv.style.background = passCount === testCases.length ? '#e8f5e9' : '#ffebee';
        summaryDiv.innerHTML = `
            <h2>Summary</h2>
            <p class="success">‚úÖ Passed: ${passCount}/${testCases.length}</p>
            ${failCount > 0 ? `<p class="error">‚ùå Failed: ${failCount}/${testCases.length}</p>` : ''}
        `;
        resultsDiv.insertBefore(summaryDiv, resultsDiv.firstChild);
    </script>
</body>
</html>
